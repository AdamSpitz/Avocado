module('lively.WikiParser').requires('ometa.parser').toRun(function() {
WikiParser=Object.delegated(Parser,{
"nl":function(){var $elf=this;return this._applyWithArgs("exactly","\n")},
"createTextSpec":function(){var $elf=this;return (function (){var spec=({"string": "","attributes": []});(spec["assemble"]=(function (){var morph=new TextMorph(new Rectangle((0),(0),(10),(10)));morph.applyStyle(({"fill": Color["white"],"borderWidth": (0),"opacity": (0),"fontSize": (16)}));var text=new lively.Text.Text(spec["string"]);spec["attributes"].forEach((function (ea){text.emphasize(ea,ea["start"],ea["stop"])}));morph.setRichText(text);return morph}));(spec["add"]=(function (str){(spec["string"]+=str)}));(spec["addAttribute"]=(function (attr){spec["attributes"].push(attr)}));(spec["addAttributed"]=(function (str,attribute){(attribute["start"]=spec["string"]["length"]);spec.add(str);(attribute["stop"]=spec["string"]["length"]);spec.addAttribute(attribute)}));return spec}).call(this)},
"heading":function(){var $elf=this,start,c,cs,end;return (function(){start=this._many1((function(){return this._applyWithArgs("exactly","=")}));cs=this._many1((function(){return (function(){this._not((function(){return this._applyWithArgs("exactly","\n")}));this._not((function(){return this._applyWithArgs("exactly","=")}));c=this._apply("char");return c}).call(this)}));end=this._many1((function(){return this._applyWithArgs("exactly","=")}));this._pred((end["length"] == start["length"]));return (function (){var morph=new TextMorph(new Rectangle((0),(0),(10),(10)),cs.join(""));morph.applyStyle(({"fill": Color["white"],"borderWidth": (0),"opacity": (0),"fontSize": ((40) - (start["length"] * (6)))}));return morph}).call(this)}).call(this)},
"paragraph":function(){var $elf=this,spec;return (function(){spec=this._apply("createTextSpec");this._many1((function(){return this._applyWithArgs("atomicText",spec)}));return spec.assemble()}).call(this)},
"nestableText":function(){var $elf=this,spec;return (function(){spec=this._apply("anything");return this._or((function(){return this._applyWithArgs("atomicText",spec)}),(function(){return this._applyWithArgs("list",spec)}))}).call(this)},
"list":function(){var $elf=this,spec,level;return (function(){spec=this._apply("anything");level=this._many1((function(){return this._applyWithArgs("exactly","*")}));this._apply("spaces");(function (){spec.add(level.collect((function (ea){return "\t"})).join(""));return spec.add("â€¢ ")}).call(this);this._many1((function(){return (function(){this._not((function(){return this._applyWithArgs("exactly","\n")}));return this._or((function(){return this._applyWithArgs("bold",spec)}),(function(){return this._applyWithArgs("italic",spec)}),(function(){return this._applyWithArgs("link",spec)}),(function(){return this._applyWithArgs("wordsNoNewline",spec)}))}).call(this)}));this._or((function(){return (function(){switch(this._apply('anything')){case "\n":return "\n";default: throw fail}}).call(this)}),(function(){return this._apply("end")}));spec.add("\n");return this._many((function(){return this._applyWithArgs("list",spec)}))}).call(this)},
"atomicText":function(){var $elf=this,spec;return (function(){spec=this._apply("anything");return this._or((function(){return this._applyWithArgs("wordsNoParagraphEnd",spec)}),(function(){return this._applyWithArgs("bold",spec)}),(function(){return this._applyWithArgs("italic",spec)}),(function(){return this._applyWithArgs("link",spec)}),(function(){return this._applyWithArgs("list",spec)}),(function(){return this._applyWithArgs("trash",spec)}))}).call(this)},
"trash":function(){var $elf=this,spec,c;return (function(){spec=this._apply("anything");this._not((function(){return this._applyWithArgs("exactly","\n")}));this._not((function(){return this._apply("end")}));spec.add("<ERROR>");this._many1((function(){return (function(){c=this._apply("char");this._pred((c != "\n"));return spec.add(c)}).call(this)}));return spec.add("</ERROR>")}).call(this)},
"character":function(){var $elf=this,spec,c;return (function(){spec=this._apply("anything");c=this._apply("char");return spec.add(c)}).call(this)},
"wordsNoParagraphEnd":function(){var $elf=this,spec,c;return (function(){spec=this._apply("anything");return this._many1((function(){return (function(){this._not((function(){return this._apply("paragraphEnd")}));c=this._apply("char");this._pred(((((c != "*") && (c != "[")) && (c != "<")) && (c != "\'")));return spec.add(c)}).call(this)}))}).call(this)},
"wordsNoNewline":function(){var $elf=this,spec,c;return (function(){spec=this._apply("anything");return this._many1((function(){return (function(){c=this._apply("char");this._pred((((((c != "\n") && (c != "*")) && (c != "[")) && (c != "<")) && (c != "\'")));return spec.add(c)}).call(this)}))}).call(this)},
"bold":function(){var $elf=this,spec,c,cs;return (function(){spec=this._apply("anything");this._not((function(){return this._apply("space")}));this._applyWithArgs("token","\'\'\'");cs=this._many1((function(){return (function(){this._not((function(){return this._applyWithArgs("token","\'\'\'")}));c=this._apply("char");return c}).call(this)}));this._applyWithArgs("token","\'\'\'");return spec.addAttributed(cs.join(""),({"style": "bold"}))}).call(this)},
"italic":function(){var $elf=this,spec,c,cs;return (function(){spec=this._apply("anything");this._not((function(){return this._apply("space")}));this._applyWithArgs("token","\'\'");cs=this._many1((function(){return (function(){this._not((function(){return this._applyWithArgs("token","\'\'")}));c=this._apply("char");return c}).call(this)}));this._applyWithArgs("token","\'\'");return spec.addAttributed(cs.join(""),({"style": "italic"}))}).call(this)},
"link":function(){var $elf=this,spec,c,target,c,name;return (function(){spec=this._apply("anything");this._applyWithArgs("exactly","[");target=this._many1((function(){return (function(){this._not((function(){return this._applyWithArgs("exactly","]")}));this._not((function(){return this._apply("space")}));c=this._apply("char");return c}).call(this)}));name=this._or((function(){return (function(){this._many1((function(){return this._apply("space")}));return this._many1((function(){return (function(){this._not((function(){return this._applyWithArgs("exactly","]")}));c=this._apply("char");return c}).call(this)}))}).call(this)}),(function(){return (function(){this._apply("empty");return []}).call(this)}));this._applyWithArgs("exactly","]");return spec.addAttributed((name.join("") || target.join("")),({"link": target.join(""),"color": "blue"}))}).call(this)},
"paragraphEnd":function(){var $elf=this;return (function(){this._applyWithArgs("exactly","\n");return this._or((function(){return this._many1((function(){return this._applyWithArgs("exactly","\n")}))}),(function(){return (function(){switch(this._apply('anything')){case "=":return "=";default: throw fail}}).call(this)}))}).call(this)},
"partEnd":function(){var $elf=this;return this._or((function(){return this._many1((function(){return this._applyWithArgs("exactly","\n")}))}),(function(){return this._apply("end")}))},
"textParts":function(){var $elf=this,p;return this._many1((function(){return (function(){p=this._or((function(){return this._apply("heading")}),(function(){return this._apply("paragraph")}));this._apply("partEnd");return p}).call(this)}))},
"log":function(){var $elf=this,msg;return (function(){msg=this._apply("anything");return console.log(msg)}).call(this)},
"wikiTextDescription":function(){var $elf=this,parts;return (function(){parts=this._apply("textParts");this._apply("end");return parts}).call(this)}})
});